# TemplateGeNN
TemplateGeNN is a fast stochastic template bank generation algorithm which uses Graphical Processing Units (GPUs) and a LearningMatch model (Siamese neural network). 

In order to use TemplateGeNN please make sure you install the following key packages NumPy, Joblib, Typing, Pandas, PyTorch, h5py and PyCBC. See the `requirements.txt` for more information on versions. 

The TemplateGeNN repository conatins the following:
1) Paper - A folder containing the content used to create the results seen in the paper. 

2) `TemplateGeNN.py` - An example python script used to generate a template bank with a LearningMatch model and GPUs. This needs a 'LearningMatchModel.pth' file and 'Model.py' file.

3) `requirements.txt` - Contains information about the versions used to generate a template bank using TemplateGeNN.  

The Paper folder conatins the following:

1) PyCBCBankVerificatorBig - A folder containing the inputs and outputs of PyCBC template bank verificator. This was used to verify the entire template bank.
    a) `aLIGO140MpcT1800545psd.txt` - Power Spectral Density (PSD) used in PyCBC template bank verificator (input file).
    b) `global_setup.ini` - The setup file for PyCBC template bank verificator (input file). 
    c) `H1L1V1-BANKSIM_MATCH_COMBINE_BROADINJ1-2620801-1163865616.h5` - The injectiosn used to test the template bank (output file).
    d) `InvestigationBig.ipynb` - Jupyter Notebook used to create the graphs presented in the paper.
    e) `Model.py` - The LearningMatch model architecture used to generate the template bank for the Jupyter Notebook. 
    f) `TemplateBank.hdf` - Template bank generated by TemplateGeNN for the Jupyter Notebook.

2) PyCBCBankVerificatorSmall - A folder containing the inputs and outputs of PyCBC template bank verificator. This was used to verifiy the template bank in the low mass region, see paper for more details.
    a) `aLIGO140MpcT1800545psd.txt` - PSD used in PyCBC template bank verificator (input file).
    b) `global_setup.ini` - The setup file for PyCBC template bank verificator (input file).
    c) `H1L1V1-BANKSIM_MATCH_COMBINE_BROADINJ1-2620801-1163865616.h5` - The injectiosn used to test the template bank (output file).
    d) `InvestigationSmall.ipynb` - Jupyter Notebook used to create the graphs presented in the paper. 

3) `psd.ipynb` - Notebook used to create the PSD required for PyCBC template bank verificator. 
4) `TemplateGeNN.py` - The python script used to generate the template bank presented in the paper.
5) `LearningMatchModel.pth` - The weights and biases of the trained LearningMatch model used to generate the template bank (input file). 
6) `Model.py` - The LearningMatch model architecture used to generate the template bank (input file). 
7) `TemplateGeNN.log` - The time taken to generate a template bank (output file). 
8) `TemplateGeNN.csv` - Template bank generated by TemplateGeNN (output file). 
9) `TemplateGeNN.hdf` - Template bank generated by TemplateGeNN (output file).

